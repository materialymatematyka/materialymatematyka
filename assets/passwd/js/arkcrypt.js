// variables to be filled when generating the file
    var encryptedMsg = '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',
        salt = '7c6e1d72b23fc445aec8b3420c1393de',
        isRememberEnabled = true,
        rememberDurationInDays = 30; // 0 means forever

    // constants
    var rememberPassphraseKey = 'staticrypt_passphrase',
        rememberExpirationKey = 'staticrypt_expiration';

    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     *
     * @param  encryptedMsg
     * @param  hashedPassphrase
     * @returns 
     */
    function decryptMsg(encryptedMsg, hashedPassphrase) {
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32))
        var encrypted = encryptedMsg.substring(32);

        return CryptoJS.AES.decrypt(encrypted, hashedPassphrase, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
    }

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param  hashedPassphrase
     * @returns 
     */
    function decryptAndReplaceHtml(hashedPassphrase) {
        var encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(hashedPassphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decryptMsg(encryptedHTML, hashedPassphrase);

        document.write(plainHTML);
        document.close();

        return true;
    }

    /**
     * Salt and hash the passphrase so it can be stored in localStorage without opening a password reuse vulnerability.
     *
     * @param  passphrase
     * @returns 
     */
    function hashPassphrase(passphrase) {
        return CryptoJS.PBKDF2(passphrase, salt, {
            keySize: 256 / 32,
            iterations: 1000
        }).toString();
    }

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        localStorage.removeItem(rememberPassphraseKey);
        localStorage.removeItem(rememberExpirationKey);
    }

    // try to automatically decrypt on load if there is a saved password
    window.onload = function () {
        if (isRememberEnabled) {
            // show the remember me checkbox
            document.getElementById('staticrypt-remember-label').classList.remove('hidden');

            // if we are login out, clear the storage and terminate
            var queryParams = new URLSearchParams(window.location.search);

            if (queryParams.has("staticrypt_logout")) {
                return clearLocalStorage();
            }

            // if there is expiration configured, check if we're not beyond the expiration
            if (rememberDurationInDays && rememberDurationInDays > 0) {
                var expiration = localStorage.getItem(rememberExpirationKey),
                    isExpired = expiration && new Date().getTime() > parseInt(expiration);

                if (isExpired) {
                    return clearLocalStorage();
                }
            }

            var hashedPassphrase = localStorage.getItem(rememberPassphraseKey);

            if (hashedPassphrase) {
                // try to decrypt
                var isDecryptionSuccessful = decryptAndReplaceHtml(hashedPassphrase);

                // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
                // the user fill the password form again
                if (!isDecryptionSuccessful) {
                    return clearLocalStorage();
                }
            }
        }
    }

    // handle password form submission
    document.getElementById('staticrypt-form').addEventListener('submit', function (e) {
        e.preventDefault();

        var passphrase = document.getElementById('staticrypt-password').value,
            shouldRememberPassphrase = document.getElementById('staticrypt-remember').checked;

        // decrypt and replace the whole page
        var hashedPassphrase = hashPassphrase(passphrase);
        var isDecryptionSuccessful = decryptAndReplaceHtml(hashedPassphrase);

        if (isDecryptionSuccessful) {
            // remember the hashedPassphrase and set its expiration if necessary
            if (isRememberEnabled && shouldRememberPassphrase) {
                window.localStorage.setItem(rememberPassphraseKey, hashedPassphrase);

                // set the expiration if the duration isn't 0 (meaning no expiration)
                if (rememberDurationInDays > 0) {
                    window.localStorage.setItem(
                        rememberExpirationKey,
                        (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                    );
                }
            }
        } else {
            alert('Hasło niepoprawne!');
        }
    });