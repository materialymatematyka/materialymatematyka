// variables to be filled when generating the file
    var encryptedMsg = '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',
        salt = '3a12bd0ba37ed9d0cf3308619c6fe0f4',
        isRememberEnabled = true,
        rememberDurationInDays = 30; // 0 means forever

    // constants
    var rememberPassphraseKey = 'staticrypt_passphrase',
        rememberExpirationKey = 'staticrypt_expiration';

    /**
     * Decrypt a salted msg using a password.
     * Inspired by https://github.com/adonespitogo
     *
     * @param  encryptedMsg
     * @param  hashedPassphrase
     * @returns 
     */
    function decryptMsg(encryptedMsg, hashedPassphrase) {
        var iv = CryptoJS.enc.Hex.parse(encryptedMsg.substr(0, 32))
        var encrypted = encryptedMsg.substring(32);

        return CryptoJS.AES.decrypt(encrypted, hashedPassphrase, {
            iv: iv,
            padding: CryptoJS.pad.Pkcs7,
            mode: CryptoJS.mode.CBC
        }).toString(CryptoJS.enc.Utf8);
    }

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param  hashedPassphrase
     * @returns 
     */
    function decryptAndReplaceHtml(hashedPassphrase) {
        var encryptedHMAC = encryptedMsg.substring(0, 64),
            encryptedHTML = encryptedMsg.substring(64),
            decryptedHMAC = CryptoJS.HmacSHA256(encryptedHTML, CryptoJS.SHA256(hashedPassphrase).toString()).toString();

        if (decryptedHMAC !== encryptedHMAC) {
            return false;
        }

        var plainHTML = decryptMsg(encryptedHTML, hashedPassphrase);

        document.write(plainHTML);
        document.close();

        return true;
    }

    /**
     * Salt and hash the passphrase so it can be stored in localStorage without opening a password reuse vulnerability.
     *
     * @param  passphrase
     * @returns 
     */
    function hashPassphrase(passphrase) {
        return CryptoJS.PBKDF2(passphrase, salt, {
            keySize: 256 / 32,
            iterations: 1000
        }).toString();
    }

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        localStorage.removeItem(rememberPassphraseKey);
        localStorage.removeItem(rememberExpirationKey);
    }

    // try to automatically decrypt on load if there is a saved password
    window.onload = function () {
        if (isRememberEnabled) {
            // show the remember me checkbox
            document.getElementById('staticrypt-remember-label').classList.remove('hidden');

            // if we are login out, clear the storage and terminate
            var queryParams = new URLSearchParams(window.location.search);

            if (queryParams.has("staticrypt_logout")) {
                return clearLocalStorage();
            }

            // if there is expiration configured, check if we're not beyond the expiration
            if (rememberDurationInDays && rememberDurationInDays > 0) {
                var expiration = localStorage.getItem(rememberExpirationKey),
                    isExpired = expiration && new Date().getTime() > parseInt(expiration);

                if (isExpired) {
                    return clearLocalStorage();
                }
            }

            var hashedPassphrase = localStorage.getItem(rememberPassphraseKey);

            if (hashedPassphrase) {
                // try to decrypt
                var isDecryptionSuccessful = decryptAndReplaceHtml(hashedPassphrase);

                // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
                // the user fill the password form again
                if (!isDecryptionSuccessful) {
                    return clearLocalStorage();
                }
            }
        }
    }

    // handle password form submission
    document.getElementById('staticrypt-form').addEventListener('submit', function (e) {
        e.preventDefault();

        var passphrase = document.getElementById('staticrypt-password').value,
            shouldRememberPassphrase = document.getElementById('staticrypt-remember').checked;

        // decrypt and replace the whole page
        var hashedPassphrase = hashPassphrase(passphrase);
        var isDecryptionSuccessful = decryptAndReplaceHtml(hashedPassphrase);

        if (isDecryptionSuccessful) {
            // remember the hashedPassphrase and set its expiration if necessary
            if (isRememberEnabled && shouldRememberPassphrase) {
                window.localStorage.setItem(rememberPassphraseKey, hashedPassphrase);

                // set the expiration if the duration isn't 0 (meaning no expiration)
                if (rememberDurationInDays > 0) {
                    window.localStorage.setItem(
                        rememberExpirationKey,
                        (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                    );
                }
            }
        } else {
            alert('Hasło niepoprawne!');
        }
    });